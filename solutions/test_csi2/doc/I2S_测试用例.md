## I2S

### 概要

该文档主要描述I2S模块的CSI2.0自动化测试AT命令。 文档中所涉及的这些命令是用来测试I2S模块的接口工作是否正常、数据传输是否正确、接口返回值是否符合预期。


### 测试原理

测试时，应使被测试板与另外一块具备I2S功能的板子连接，并发送AT+PINMUX_CONFIG到被测试板把需要测试的引脚功能复用成I2S的引脚功能后，然后发送I2S测试命令进行相应的测试；测试程序会按照按照测试命令的配置进行相应的数据收发测试， 若接收方接收到的数据与预期一致，则相应的测试成功完成，否则测试失败。


### 测试流程

- 测试前应当准备好测试板（以下简称A板）、测试辅助板（以下简称B板）
- 选定需要测试的I2S针脚，并把A、B两块板子的I2S功能针脚相连
- 发送PINMUX_CONFIG命令到A板、B板， 把以上选定的引脚复用成SPI功能
- 发送I2S测试命令进行测试 （测试命令功能请参照下文）



### AT命令列表

以下是I2S模块对应的测试命令列表及其功能简要介绍。

| AT命令列表            | 功能                                 |
| --------------------- | ------------------------------------ |
| AT+I2S_DMA_RECEIVE_S  | 测试I2S模块DMA模式下Slave的接收功能  |
| AT+I2S_DMA_SEND_M     | 测试I2S模块DMA模式下MAster的接收功能 |
| AT+I2S_SYNC_RECEIVE_S | 测试I2S模块同步模式下Slave的接收功能 |
| AT+I2S_SYNC_SEND_M    | 测试I2S模块同步模式下Master的发送功能|
| AT+I2S_ASYNC_RECEIVE_S| 测试I2S模块异步模式下Slave的接收功能 |
| AT+I2S_ASYNC_SEND_M   | 测试I2S模块异步模式下Master的发送功能|

### 命令详解

| 命令格式 | AT+I2S_DMA_RECEIVE_S |
|------------------------------------------|--------------------------------------------------------------------------------------------------|
| 命令功能 | 测试I2S模块DMA模式下Slave的接收功能 |
| 命令参数 | idx：设备号 |
| 示例     | 分别对A、B两块开发板发送AT+PINMUX_CONFIG=1,23,1、AT+PINMUX_CONFIG=1,24,1、AT+PINMUX_CONFIG=1,25,1命令，将两块板的引脚复用成I2S功能引脚，
然后再分别对A板和B板发送AT测试命令，先对A板发送AT+I2S_DMA_RECEIVE_S=8000,16,0,0,512；<br/>然后再对B板发送AT+I2S_DMA_SEND_M=8000,16,0,0,512，发送命令之后，A板和B板会分别打印OK，即为测试成功，否则测试失败<br/> |
| 可搭配的辅助测试命令 | AT+I2S_DMA_SEND_M |

| 命令格式 | AT+I2S_DMA_SEND_M |
|------------------------------------------|--------------------------------------------------------------------------------------------------|
| 命令功能 | 测试I2S模块DMA模式下Master的发送功能 |
| 命令参数 | idx：设备号 |
| 示例     | 分别对A、B两块开发板发送AT+PINMUX_CONFIG=1,23,1、AT+PINMUX_CONFIG=1,24,1、AT+PINMUX_CONFIG=1,25,1命令，将两块板的引脚复用成I2S功能引脚，
然后再分别对A板和B板发送AT测试命令，先对A板发送AT+I2S_DMA_RECEIVE_S=8000,16,0,0,512；<br/>然后再对B板发送AT+I2S_DMA_SEND_M=8000,16,0,0,512，发送命令之后，A板和B板会分别打印OK，即为测试成功，否则测试失败<br/> |
| 可搭配的辅助测试命令 | AT+I2S_DMA_RECEIVE_S |

| 命令格式 | AT+I2S_SYNC_RECEIVE_S |
|------------------------------------------|--------------------------------------------------------------------------------------------------|
| 命令功能 | 测试I2S模块SYNC模式下Slave的接收功能 |
| 命令参数 | idx：设备号 |
| 示例     | 分别对A、B两块开发板发送AT+PINMUX_CONFIG=1,23,1、AT+PINMUX_CONFIG=1,24,1、AT+PINMUX_CONFIG=1,25,1命令，将两块板的引脚复用成I2S功能引脚，
然后再分别对A板和B板发送AT测试命令，先对A板发送AT+I2S_SYNC_RECEIVE_S=8000,16,0,0,512；<br/>然后再对B板发送AT+I2S_SYNC_SEND_M=8000,16,0,0,512，发送命令之后，A板和B板会分别打印OK，即为测试成功，否则测试失败<br/> |
| 可搭配的辅助测试命令 | AT+I2S_SYNC_SEND_M |

| 命令格式 | AT+I2S_SYNC_SEND_M |
|------------------------------------------|--------------------------------------------------------------------------------------------------|
| 命令功能 | 测试I2S模块SYNC模式下Master的发送功能 |
| 命令参数 | idx：设备号 |
| 示例     | 分别对A、B两块开发板发送AT+PINMUX_CONFIG=1,23,1、AT+PINMUX_CONFIG=1,24,1、AT+PINMUX_CONFIG=1,25,1命令，将两块板的引脚复用成I2S功能引脚，
然后再分别对A板和B板发送AT测试命令，先对A板发送AT+I2S_SYNC_RECEIVE_S=8000,16,0,0,512；<br/>然后再对B板发送AT+I2S_SYNC_SEND_M=8000,16,0,0,512，发送命令之后，A板和B板会分别打印OK，即为测试成功，否则测试失败<br/> |
| 可搭配的辅助测试命令 | AT+I2S_SYNC_RECEIVE_S |

| 命令格式 | AT+I2S_ASYNC_RECEIVE_S |
|------------------------------------------|--------------------------------------------------------------------------------------------------|
| 命令功能 | 测试I2S模块ASYNC模式下Slave的接收功能 |
| 命令参数 | idx：设备号 |
| 示例     | 分别对A、B两块开发板发送AT+PINMUX_CONFIG=1,23,1、AT+PINMUX_CONFIG=1,24,1、AT+PINMUX_CONFIG=1,25,1命令，将两块板的引脚复用成I2S功能引脚，
然后再分别对A板和B板发送AT测试命令，先对A板发送AT+I2S_ASYNC_RECEIVE_S=8000,16,0,0,512；<br/>然后再对B板发送AT+I2S_ASYNC_SEND_M=8000,16,0,0,512，发送命令之后，A板和B板会分别打印OK，即为测试成功，否则测试失败<br/> |
| 可搭配的辅助测试命令 | AT+I2S_DMA_SEND_M |

| 命令格式 | AT+I2S_ASYNC_SEND_M |
|------------------------------------------|--------------------------------------------------------------------------------------------------|
| 命令功能 | 测试I2S模块ASYNC模式下Master的发送功能 |
| 命令参数 | idx：设备号 |
| 示例     | 分别对A、B两块开发板发送AT+PINMUX_CONFIG=1,23,1、AT+PINMUX_CONFIG=1,24,1、AT+PINMUX_CONFIG=1,25,1命令，将两块板的引脚复用成I2S功能引脚，
然后再分别对A板和B板发送AT测试命令，先对A板发送AT+I2S_ASYNC_RECEIVE_S=8000,16,0,0,512；<br/>然后再对B板发送AT+I2S_ASYNC_SEND_M=8000,16,0,0,512，发送命令之后，A板和B板会分别打印OK，即为测试成功，否则测试失败<br/> |
| 可搭配的辅助测试命令 | AT+I2S_ASYNC_RECEIVE_S |
### 
